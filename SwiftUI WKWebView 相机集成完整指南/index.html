<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"sseen.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.22.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"hide","padding":18,"offset":12},"hljswrap":false,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":150,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="aiå¯ä»¥éšæ„ç”Ÿæˆå¾ˆå¤šé«˜è´¨é‡å†…å®¹ï¼Œä½†æ˜¯åŒä¸€ä¸ªé—®é¢˜æ¯æ¬¡çœ‹ç”Ÿæˆçš„æ–°çš„ç»“æœæœªå…å¤ªç´¯ï¼Œç†Ÿæ‚‰çš„å†…å®¹å¤šæ¬¡é‡å¤å€’æ˜¯ä¸é”™çš„æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå½“ä¸‹æˆ‘è®°å½•çš„ç†ç”±ï¼Œå½“ç„¶å†™ç‚¹ä¸œè¥¿ä¸€ç›´æ˜¯å­¦ä¸€ä¸ªè¯­è¨€æœ€ç›´æ¥é«˜çº§çš„æ–¹å¼ï¼Œå› ä¸ºéš¾åº¦æœ€å¤§æ•ˆæœæ‰æœ€å¥½ï¼ŒåšæŒå–½ æœ¬æ–‡ç”± Cursor ç”Ÿæˆï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ SwiftUI ä¸­ä½¿ç”¨ WKWebView å®ç° H5 ä¸åŸç”Ÿç›¸æœºçš„äº¤äº’ï¼Œæ”¯æŒè¿œç¨‹ URL å’Œæœ¬åœ° HTML ä¸¤ç§åŠ è½½æ–¹å¼ã€‚  psè¿‘æœŸ">
<meta property="og:type" content="article">
<meta property="og:title" content="SwiftUI WKWebView ç›¸æœºé›†æˆå®Œæ•´æŒ‡å—">
<meta property="og:url" content="https://sseen.github.io/SwiftUI%20WKWebView%20%E7%9B%B8%E6%9C%BA%E9%9B%86%E6%88%90%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="è®¸ç¬‹çš„ blog">
<meta property="og:description" content="aiå¯ä»¥éšæ„ç”Ÿæˆå¾ˆå¤šé«˜è´¨é‡å†…å®¹ï¼Œä½†æ˜¯åŒä¸€ä¸ªé—®é¢˜æ¯æ¬¡çœ‹ç”Ÿæˆçš„æ–°çš„ç»“æœæœªå…å¤ªç´¯ï¼Œç†Ÿæ‚‰çš„å†…å®¹å¤šæ¬¡é‡å¤å€’æ˜¯ä¸é”™çš„æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå½“ä¸‹æˆ‘è®°å½•çš„ç†ç”±ï¼Œå½“ç„¶å†™ç‚¹ä¸œè¥¿ä¸€ç›´æ˜¯å­¦ä¸€ä¸ªè¯­è¨€æœ€ç›´æ¥é«˜çº§çš„æ–¹å¼ï¼Œå› ä¸ºéš¾åº¦æœ€å¤§æ•ˆæœæ‰æœ€å¥½ï¼ŒåšæŒå–½ æœ¬æ–‡ç”± Cursor ç”Ÿæˆï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ SwiftUI ä¸­ä½¿ç”¨ WKWebView å®ç° H5 ä¸åŸç”Ÿç›¸æœºçš„äº¤äº’ï¼Œæ”¯æŒè¿œç¨‹ URL å’Œæœ¬åœ° HTML ä¸¤ç§åŠ è½½æ–¹å¼ã€‚  psè¿‘æœŸ">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-11-14T11:17:00.000Z">
<meta property="article:modified_time" content="2025-12-19T07:19:01.839Z">
<meta property="article:author" content="sseen">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="SwiftUI">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="Cursor">
<meta property="article:tag" content="WKWebView">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://sseen.github.io/SwiftUI%20WKWebView%20%E7%9B%B8%E6%9C%BA%E9%9B%86%E6%88%90%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://sseen.github.io/SwiftUI%20WKWebView%20%E7%9B%B8%E6%9C%BA%E9%9B%86%E6%88%90%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/","path":"SwiftUI WKWebView ç›¸æœºé›†æˆå®Œæ•´æŒ‡å—/","title":"SwiftUI WKWebView ç›¸æœºé›†æˆå®Œæ•´æŒ‡å—"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>SwiftUI WKWebView ç›¸æœºé›†æˆå®Œæ•´æŒ‡å— | è®¸ç¬‹çš„ blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
  <div class="innerClipped">
    <div class="background"></div>
    <div class="fill"></div>
    <div class="mask"></div>
    <div class="shadow"></div>
    <div class="light"></div>
    <div class="gloss"></div>
    <div class="text">è®¸ç¬‹çš„ blog </div>
  </div>
</a>
      <p class="site-subtitle" itemprop="description">å¤§å¹³å±‚</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8B-%E7%9B%AE%E5%BD%95"><span class="nav-number">1.</span> <span class="nav-text">ğŸ“‹ ç›®å½•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%AF-%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="nav-number">2.</span> <span class="nav-text">ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%A7-%E5%AE%8C%E6%95%B4%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.</span> <span class="nav-text">ğŸ”§ å®Œæ•´å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%B8%8F%E2%83%A3-SwiftUI-%E5%85%A5%E5%8F%A3"><span class="nav-number">3.1.</span> <span class="nav-text">1ï¸âƒ£ SwiftUI å…¥å£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%B8%8F%E2%83%A3-UIViewControllerRepresentable-%E5%8C%85%E8%A3%85%E5%99%A8"><span class="nav-number">3.2.</span> <span class="nav-text">2ï¸âƒ£ UIViewControllerRepresentable åŒ…è£…å™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%EF%B8%8F%E2%83%A3-WebViewController-%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.3.</span> <span class="nav-text">3ï¸âƒ£ WebViewController æ ¸å¿ƒå®ç°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%80-%E4%B8%A4%E7%A7%8D%E5%8A%A0%E8%BD%BD%E6%96%B9%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">ğŸ”€ ä¸¤ç§åŠ è½½æ–¹å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F-1%EF%BC%9A%E5%8A%A0%E8%BD%BD%E8%BF%9C%E7%A8%8B-URL%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">4.1.</span> <span class="nav-text">æ–¹å¼ 1ï¼šåŠ è½½è¿œç¨‹ URLï¼ˆæ¨èï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F-2%EF%BC%9A%E5%8A%A0%E8%BD%BD%E6%9C%AC%E5%9C%B0-HTML-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">4.2.</span> <span class="nav-text">æ–¹å¼ 2ï¼šåŠ è½½æœ¬åœ° HTML å­—ç¬¦ä¸²</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8C%90-H5-%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="nav-number">5.</span> <span class="nav-text">ğŸŒ H5 ç«¯å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TypeScript-%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-number">5.1.</span> <span class="nav-text">TypeScript ç±»å‹å£°æ˜ï¼ˆå¯é€‰ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%90-%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE"><span class="nav-number">6.</span> <span class="nav-text">ğŸ” æƒé™é…ç½®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%84-%E4%BA%A4%E4%BA%92%E6%B5%81%E7%A8%8B"><span class="nav-number">7.</span> <span class="nav-text">ğŸ”„ äº¤äº’æµç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%9D-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="nav-number">8.</span> <span class="nav-text">ğŸ“ å¸¸è§é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Q1-%E7%9B%B8%E6%9C%BA%E5%9C%A8%E6%A8%A1%E6%8B%9F%E5%99%A8%E4%B8%8A%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%EF%BC%9F"><span class="nav-number">8.1.</span> <span class="nav-text">Q1: ç›¸æœºåœ¨æ¨¡æ‹Ÿå™¨ä¸Šæ— æ³•ä½¿ç”¨ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Q2-JS-%E8%B0%83%E7%94%A8%E6%B2%A1%E6%9C%89%E5%8F%8D%E5%BA%94%EF%BC%9F"><span class="nav-number">8.2.</span> <span class="nav-text">Q2: JS è°ƒç”¨æ²¡æœ‰ååº”ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Q3-%E5%A6%82%E4%BD%95%E8%B0%83%E8%AF%95-H5-%E9%A1%B5%E9%9D%A2%EF%BC%9F"><span class="nav-number">8.3.</span> <span class="nav-text">Q3: å¦‚ä½•è°ƒè¯• H5 é¡µé¢ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Q4-%E9%9C%80%E8%A6%81%E6%94%AF%E6%8C%81%E5%A4%9A%E4%B8%AA-JS-Handler%EF%BC%9F"><span class="nav-number">8.4.</span> <span class="nav-text">Q4: éœ€è¦æ”¯æŒå¤šä¸ª JS Handlerï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%AF-%E6%80%BB%E7%BB%93"><span class="nav-number">9.</span> <span class="nav-text">ğŸ¯ æ€»ç»“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%9A-%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB"><span class="nav-number">10.</span> <span class="nav-text">ğŸ“š æ‰©å±•é˜…è¯»</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">sseen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">277</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">329</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://sseen.github.io/SwiftUI%20WKWebView%20%E7%9B%B8%E6%9C%BA%E9%9B%86%E6%88%90%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="sseen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è®¸ç¬‹çš„ blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="SwiftUI WKWebView ç›¸æœºé›†æˆå®Œæ•´æŒ‡å— | è®¸ç¬‹çš„ blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SwiftUI WKWebView ç›¸æœºé›†æˆå®Œæ•´æŒ‡å—
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-14 11:17:00" itemprop="dateCreated datePublished" datetime="2025-11-14T11:17:00+00:00">2025-11-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-12-19 07:19:01" itemprop="dateModified" datetime="2025-12-19T07:19:01+00:00">2025-12-19</time>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><blockquote>
<p>aiå¯ä»¥éšæ„ç”Ÿæˆå¾ˆå¤šé«˜è´¨é‡å†…å®¹ï¼Œä½†æ˜¯åŒä¸€ä¸ªé—®é¢˜æ¯æ¬¡çœ‹ç”Ÿæˆçš„æ–°çš„ç»“æœæœªå…å¤ªç´¯ï¼Œç†Ÿæ‚‰çš„å†…å®¹å¤šæ¬¡é‡å¤å€’æ˜¯ä¸é”™çš„æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå½“ä¸‹æˆ‘è®°å½•çš„ç†ç”±ï¼Œå½“ç„¶å†™ç‚¹ä¸œè¥¿ä¸€ç›´æ˜¯å­¦ä¸€ä¸ªè¯­è¨€æœ€ç›´æ¥é«˜çº§çš„æ–¹å¼ï¼Œå› ä¸ºéš¾åº¦æœ€å¤§æ•ˆæœæ‰æœ€å¥½ï¼ŒåšæŒå–½<br>
æœ¬æ–‡ç”± Cursor ç”Ÿæˆï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ SwiftUI ä¸­ä½¿ç”¨ WKWebView å®ç° H5 ä¸åŸç”Ÿç›¸æœºçš„äº¤äº’ï¼Œæ”¯æŒè¿œç¨‹ URL å’Œæœ¬åœ° HTML ä¸¤ç§åŠ è½½æ–¹å¼ã€‚</p>
</blockquote>
<p>psè¿‘æœŸé¡¹ç›®çš„ä¸€ä¸ªé—®é¢˜åˆšå¥½ï¼Œnativeå’Œangularç»“åˆçš„hyperappï¼Œä½†æ˜¯å‘¢æ‹ç…§çš„js-nativeäº¤äº’</p>
<ol>
<li>ä¹‹å‰æ²¡æœ‰ç”¨js-nativeäº¤äº’ï¼Œç”¨çš„inputæ ‡ç­¾æ‹ç…§ï¼Œæœ€åæµ‹è¯•å‘ç°iOS17åŸºæœ¬å„ä¸ªç‰ˆæœ¬éƒ½ä¸èƒ½ç”¨ï¼Œä¸€è°ƒèµ·ç›¸æœºæ•´ä¸ªwebå°±é‡æ–°åˆ·æ–°ï¼›</li>
<li>æ”¹æˆäº¤äº’å¥½å¤šäº†ï¼Œä½†æ˜¯ç‹¬ç‹¬iOS17.7.1æœ‰ä¹‹å‰çš„é—®é¢˜</li>
<li>åé¢å®¢æˆ·é‚£è¾¹æ‹¿äº†çœŸæœºè¿‡æ¥ï¼Œè‡ªå·±å†™äº†iOSç‰ˆçš„æµ‹è¯•ï¼Œç«Ÿç„¶æ²¡é—®é¢˜ï¼Œçœ‹æ¥æ˜¯ä»–ä»¬å£³çš„é—®é¢˜</li>
</ol>
<p>è¿™ä¸ªé¡¹ç›®æ€»ç»“ä¸‹æ¥ä¸¤ä¸ªå¥‡æ€ªçš„é—®é¢˜</p>
<ol>
<li>ä¸Šé¢çš„iOS17.7.1é—®é¢˜</li>
<li>iOSä¸Šçš„inputæ ‡ç­¾å“åº”èšç„¦é—®é¢˜ï¼Œæ ¹æœ¬ä¸èƒ½æ§åˆ¶</li>
</ol>
<h2 id="ğŸ“‹-ç›®å½•">ğŸ“‹ ç›®å½•</h2>
<ul>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD">æ ¸å¿ƒåŠŸèƒ½</a></li>
<li><a href="#%E5%AE%8C%E6%95%B4%E5%AE%9E%E7%8E%B0">å®Œæ•´å®ç°</a></li>
<li><a href="#%E4%B8%A4%E7%A7%8D%E5%8A%A0%E8%BD%BD%E6%96%B9%E5%BC%8F">ä¸¤ç§åŠ è½½æ–¹å¼</a></li>
<li><a href="#h5-%E7%AB%AF%E5%AE%9E%E7%8E%B0">H5 ç«¯å®ç°</a></li>
<li><a href="#%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE">æƒé™é…ç½®</a></li>
<li><a href="#%E4%BA%A4%E4%BA%92%E6%B5%81%E7%A8%8B">äº¤äº’æµç¨‹</a></li>
</ul>
<hr>
<h2 id="ğŸ¯-æ ¸å¿ƒåŠŸèƒ½">ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</h2>
<p>å®ç° H5 é¡µé¢ä¸ iOS åŸç”Ÿç›¸æœºçš„æ— ç¼äº¤äº’ï¼š</p>
<ol>
<li><strong>H5 â†’ Native</strong>ï¼šç½‘é¡µè°ƒç”¨åŸç”Ÿç›¸æœº</li>
<li><strong>Native â†’ H5</strong>ï¼šæ‹ç…§åå°† base64 å›¾ç‰‡æ•°æ®å›ä¼ ç»™ç½‘é¡µ</li>
<li><strong>åŒå‘é€šä¿¡</strong>ï¼šä½¿ç”¨ <code>WKScriptMessageHandler</code> å’Œ <code>evaluateJavaScript</code></li>
</ol>
<hr>
<h2 id="ğŸ”§-å®Œæ•´å®ç°">ğŸ”§ å®Œæ•´å®ç°</h2>
<h3 id="1ï¸âƒ£-SwiftUI-å…¥å£">1ï¸âƒ£ SwiftUI å…¥å£</h3>
<pre class="language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span>

<span class="token attribute atrule">@main</span>
<span class="token keyword">struct</span> <span class="token class-name">WebCameraApp</span><span class="token punctuation">:</span> <span class="token class-name">App</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">Scene</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">WindowGroup</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ContentView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">WebContainerView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ignoresSafeArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h3 id="2ï¸âƒ£-UIViewControllerRepresentable-åŒ…è£…å™¨">2ï¸âƒ£ UIViewControllerRepresentable åŒ…è£…å™¨</h3>
<pre class="language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span>
<span class="token keyword">import</span> <span class="token class-name">WebKit</span>

<span class="token keyword">struct</span> <span class="token class-name">WebContainerView</span><span class="token punctuation">:</span> <span class="token class-name">UIViewControllerRepresentable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">makeUIViewController</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">WebViewController</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">WebViewController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">func</span> <span class="token function-definition function">updateUIViewController</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> uiViewController<span class="token punctuation">:</span> <span class="token class-name">WebViewController</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h3 id="3ï¸âƒ£-WebViewController-æ ¸å¿ƒå®ç°">3ï¸âƒ£ WebViewController æ ¸å¿ƒå®ç°</h3>
<pre class="language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">UIKit</span>
<span class="token keyword">import</span> <span class="token class-name">WebKit</span>

<span class="token keyword">class</span> <span class="token class-name">WebViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span><span class="token punctuation">,</span>
                         <span class="token class-name">WKScriptMessageHandler</span><span class="token punctuation">,</span>
                         <span class="token class-name">UIImagePickerControllerDelegate</span><span class="token punctuation">,</span>
                         <span class="token class-name">UINavigationControllerDelegate</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">var</span> webView<span class="token punctuation">:</span> <span class="token class-name">WKWebView</span><span class="token operator">!</span>
    <span class="token keyword">var</span> imagePicker<span class="token punctuation">:</span> <span class="token class-name">UIImagePickerController</span><span class="token operator">?</span>

    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// 1. é…ç½® WKWebView</span>
        <span class="token keyword">let</span> contentController <span class="token operator">=</span> <span class="token class-name">WKUserContentController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        contentController<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"takePhoto"</span></span><span class="token punctuation">)</span>   <span class="token comment">// JS è°ƒç”¨å…¥å£</span>

        <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token class-name">WKWebViewConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        config<span class="token punctuation">.</span>userContentController <span class="token operator">=</span> contentController

        webView <span class="token operator">=</span> <span class="token class-name">WKWebView</span><span class="token punctuation">(</span>frame<span class="token punctuation">:</span> <span class="token punctuation">.</span>zero<span class="token punctuation">,</span> configuration<span class="token punctuation">:</span> config<span class="token punctuation">)</span>
        webView<span class="token punctuation">.</span>translatesAutoresizingMaskIntoConstraints <span class="token operator">=</span> <span class="token boolean">false</span>
        view<span class="token punctuation">.</span><span class="token function">addSubview</span><span class="token punctuation">(</span>webView<span class="token punctuation">)</span>

        <span class="token class-name">NSLayoutConstraint</span><span class="token punctuation">.</span><span class="token function">activate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            webView<span class="token punctuation">.</span>topAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>topAnchor<span class="token punctuation">)</span><span class="token punctuation">,</span>
            webView<span class="token punctuation">.</span>bottomAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>bottomAnchor<span class="token punctuation">)</span><span class="token punctuation">,</span>
            webView<span class="token punctuation">.</span>leadingAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>leadingAnchor<span class="token punctuation">)</span><span class="token punctuation">,</span>
            webView<span class="token punctuation">.</span>trailingAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>trailingAnchor<span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment">// 2. åŠ è½½ç½‘é¡µï¼ˆè§ä¸‹æ–¹ä¸¤ç§æ–¹å¼ï¼‰</span>
        <span class="token function">loadWebContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">deinit</span> <span class="token punctuation">&#123;</span>
        webView<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>userContentController<span class="token punctuation">.</span><span class="token function">removeScriptMessageHandler</span><span class="token punctuation">(</span>forName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"takePhoto"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// 3. JS â†’ Nativeï¼šæ¥æ”¶æ‹ç…§è¯·æ±‚</span>
    <span class="token keyword">func</span> <span class="token function-definition function">userContentController</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> userContentController<span class="token punctuation">:</span> <span class="token class-name">WKUserContentController</span><span class="token punctuation">,</span>
                               didReceive message<span class="token punctuation">:</span> <span class="token class-name">WKScriptMessage</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> message<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"takePhoto"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token function">openCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// 4. æ‰“å¼€ç›¸æœº</span>
    <span class="token keyword">func</span> <span class="token function-definition function">openCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">guard</span> <span class="token class-name">UIImagePickerController</span><span class="token punctuation">.</span><span class="token function">isSourceTypeAvailable</span><span class="token punctuation">(</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"ç›¸æœºä¸å¯ç”¨ï¼Œè¯·ä½¿ç”¨çœŸæœºæµ‹è¯•"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">let</span> picker <span class="token operator">=</span> <span class="token class-name">UIImagePickerController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        picker<span class="token punctuation">.</span>sourceType <span class="token operator">=</span> <span class="token punctuation">.</span>camera
        picker<span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token keyword">self</span>
        picker<span class="token punctuation">.</span>allowsEditing <span class="token operator">=</span> <span class="token boolean">false</span>
        imagePicker <span class="token operator">=</span> picker

        <span class="token function">present</span><span class="token punctuation">(</span>picker<span class="token punctuation">,</span> animated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// 5. æ‹ç…§å®Œæˆï¼šè½¬ base64 å¹¶å›ä¼ ç»™ JS</span>
    <span class="token keyword">func</span> <span class="token function-definition function">imagePickerController</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> picker<span class="token punctuation">:</span> <span class="token class-name">UIImagePickerController</span><span class="token punctuation">,</span>
                               didFinishPickingMediaWithInfo info<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">UIImagePickerController</span><span class="token punctuation">.</span><span class="token class-name">InfoKey</span> <span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        picker<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span>animated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>

        <span class="token keyword">guard</span> <span class="token keyword">let</span> image <span class="token operator">=</span> info<span class="token punctuation">[</span><span class="token punctuation">.</span>originalImage<span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">UIImage</span><span class="token punctuation">,</span>
              <span class="token keyword">let</span> data <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token function">jpegData</span><span class="token punctuation">(</span>compressionQuality<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">&#125;</span>

        <span class="token keyword">let</span> base64 <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">base64EncodedString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦</span>
        <span class="token keyword">let</span> escapedBase64 <span class="token operator">=</span> base64
            <span class="token punctuation">.</span><span class="token function">replacingOccurrences</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"\\"</span></span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"\\\\"</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replacingOccurrences</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"'"</span></span><span class="token punctuation">,</span>  with<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"\\'"</span></span><span class="token punctuation">)</span>

        <span class="token comment">// Native â†’ JS</span>
        <span class="token keyword">let</span> js <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"window.onNativePhoto &amp;&amp; window.onNativePhoto('</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">escapedBase64</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">');"</span></span>

        webView<span class="token punctuation">.</span><span class="token function">evaluateJavaScript</span><span class="token punctuation">(</span>js<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token omit keyword">_</span><span class="token punctuation">,</span> error <span class="token keyword">in</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> error <span class="token operator">=</span> error <span class="token punctuation">&#123;</span>
                <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"JS è°ƒç”¨å¤±è´¥ï¼š"</span></span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">func</span> <span class="token function-definition function">imagePickerControllerDidCancel</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> picker<span class="token punctuation">:</span> <span class="token class-name">UIImagePickerController</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        picker<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span>animated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// â­ï¸ åŠ è½½ç½‘é¡µå†…å®¹ï¼ˆæ ¹æ®éœ€æ±‚é€‰æ‹©æ–¹å¼ï¼‰</span>
    <span class="token keyword">func</span> <span class="token function-definition function">loadWebContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// æ–¹å¼é€‰æ‹©ï¼šè§ä¸‹ä¸€èŠ‚</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<hr>
<h2 id="ğŸ”€-ä¸¤ç§åŠ è½½æ–¹å¼">ğŸ”€ ä¸¤ç§åŠ è½½æ–¹å¼</h2>
<h3 id="æ–¹å¼-1ï¼šåŠ è½½è¿œç¨‹-URLï¼ˆæ¨èï¼‰">æ–¹å¼ 1ï¼šåŠ è½½è¿œç¨‹ URLï¼ˆæ¨èï¼‰</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šH5 é¡µé¢ç‹¬ç«‹éƒ¨ç½²ï¼Œå‰åç«¯åˆ†ç¦»</p>
<pre class="language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">loadWebContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// â­ï¸ åŠ è½½è¿œç¨‹ URL</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"https://ä½ çš„ç½‘ç«™.com/camera-demo.html"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        webView<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">URLRequest</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> url<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… H5 ä»£ç ç‹¬ç«‹ç»´æŠ¤ï¼Œæ›´æ–°æ— éœ€é‡æ–°æ‰“åŒ… App</li>
<li>âœ… æ”¯æŒçƒ­æ›´æ–°</li>
<li>âœ… å‰ç«¯å¯ç‹¬ç«‹è°ƒè¯•</li>
</ul>
<h3 id="æ–¹å¼-2ï¼šåŠ è½½æœ¬åœ°-HTML-å­—ç¬¦ä¸²">æ–¹å¼ 2ï¼šåŠ è½½æœ¬åœ° HTML å­—ç¬¦ä¸²</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç®€å•é¡µé¢ã€ç¦»çº¿åŠŸèƒ½ã€å¿«é€ŸåŸå‹</p>
<pre class="language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">loadWebContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// â­ï¸ åŠ è½½æœ¬åœ° HTML å­—ç¬¦ä¸²</span>
    webView<span class="token punctuation">.</span><span class="token function">loadHTMLString</span><span class="token punctuation">(</span>htmlString<span class="token punctuation">,</span> baseURL<span class="token punctuation">:</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> htmlString<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">&#123;</span>
    <span class="token string-literal"><span class="token string">"""
    &lt;!DOCTYPE html>
    &lt;html>
    &lt;body>
        &lt;h3>SwiftUI + WKWebView æ‹ç…§ demo&lt;/h3>
        &lt;button onclick="takePhoto()">æ‹ç…§&lt;/button>
        &lt;p>é¢„è§ˆï¼š&lt;/p>
        &lt;img id="preview" style="max-width: 100%; border: 1px solid #ccc;" />

        &lt;script>
            // JS å‘èµ·æ‹ç…§
            function takePhoto() &#123;
                if (window.webkit?.messageHandlers?.takePhoto) &#123;
                    window.webkit.messageHandlers.takePhoto.postMessage(null);
                &#125; else &#123;
                    alert('native é€šé“ä¸å¯ç”¨');
                &#125;
            &#125;

            // æ¥æ”¶ base64 å›¾ç‰‡
            window.onNativePhoto = function(base64) &#123;
                document.getElementById('preview').src = 'data:image/jpeg;base64,' + base64;
                console.log('æ”¶åˆ° base64 é•¿åº¦:', base64.length);
            &#125;
        &lt;/script>
    &lt;/body>
    &lt;/html>
    """</span></span>
<span class="token punctuation">&#125;</span></code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… æ— éœ€ç½‘ç»œè¯·æ±‚</li>
<li>âœ… é€‚åˆç®€å•é¡µé¢</li>
<li>âœ… è°ƒè¯•æ–¹ä¾¿</li>
</ul>
<hr>
<h2 id="ğŸŒ-H5-ç«¯å®ç°">ğŸŒ H5 ç«¯å®ç°</h2>
<p>å¦‚æœä½¿ç”¨<strong>æ–¹å¼ 1ï¼ˆè¿œç¨‹ URLï¼‰</strong>ï¼Œä½ çš„ç½‘é¡µéœ€è¦åŒ…å«ä»¥ä¸‹ JS ä»£ç ï¼š</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">takePhoto</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>æ‹ç…§<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>preview<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">max-width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token punctuation">/></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
        <span class="token comment">// 1. è°ƒç”¨åŸç”Ÿç›¸æœº</span>
        <span class="token keyword">function</span> <span class="token function">takePhoto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            window<span class="token punctuation">.</span>webkit<span class="token operator">?.</span>messageHandlers<span class="token operator">?.</span>takePhoto<span class="token operator">?.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 2. æ¥æ”¶åŸç”Ÿå›ä¼ çš„ base64</span>
        window<span class="token punctuation">.</span><span class="token function-variable function">onNativePhoto</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">base64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'preview'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'data:image/jpeg;base64,'</span> <span class="token operator">+</span> base64<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>
<h3 id="TypeScript-ç±»å‹å£°æ˜ï¼ˆå¯é€‰ï¼‰">TypeScript ç±»å‹å£°æ˜ï¼ˆå¯é€‰ï¼‰</h3>
<pre class="language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> global <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">&#123;</span>
    webkit<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      messageHandlers<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        takePhoto<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token function-variable function">postMessage</span><span class="token operator">:</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    onNativePhoto<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>base64<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<hr>
<h2 id="ğŸ”-æƒé™é…ç½®">ğŸ” æƒé™é…ç½®</h2>
<p>åœ¨ <code>Info.plist</code> ä¸­æ·»åŠ ç›¸æœºæƒé™ï¼š</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">></span></span>NSCameraUsageDescription<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>key</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">></span></span>éœ€è¦ä½¿ç”¨ç›¸æœºæ‹ç…§å¹¶å›ä¼ ç»™ç½‘é¡µ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">></span></span></code></pre>
<hr>
<h2 id="ğŸ”„-äº¤äº’æµç¨‹">ğŸ”„ äº¤äº’æµç¨‹</h2>
<pre class="language-none"><code class="language-none">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®Œæ•´äº¤äº’æµç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  H5 ç«¯                          Native ç«¯
    â”‚                               â”‚
    â”‚  1. ç”¨æˆ·ç‚¹å‡»&quot;æ‹ç…§&quot;æŒ‰é’®         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
    â”‚  window.webkit.messageHandlersâ”‚
    â”‚  .takePhoto.postMessage(null) â”‚
    â”‚                               â”‚
    â”‚                          2. æ”¶åˆ°è¯·æ±‚
    â”‚                          openCamera()
    â”‚                               â”‚
    â”‚                          3. æ‰“å¼€ç›¸æœº
    â”‚                          UIImagePicker
    â”‚                               â”‚
    â”‚                          4. ç”¨æˆ·æ‹ç…§
    â”‚                               â”‚
    â”‚                          5. è½¬ base64
    â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  window.onNativePhoto(base64) â”‚
    â”‚                               â”‚
    â”‚  6. æ˜¾ç¤ºé¢„è§ˆ                  â”‚
    â”‚  img.src &#x3D; &#39;data:image&#x2F;...&#39;   â”‚
    â”‚                               â”‚</code></pre>
<hr>
<h2 id="ğŸ“-å¸¸è§é—®é¢˜">ğŸ“ å¸¸è§é—®é¢˜</h2>
<h3 id="Q1-ç›¸æœºåœ¨æ¨¡æ‹Ÿå™¨ä¸Šæ— æ³•ä½¿ç”¨ï¼Ÿ">Q1: ç›¸æœºåœ¨æ¨¡æ‹Ÿå™¨ä¸Šæ— æ³•ä½¿ç”¨ï¼Ÿ</h3>
<p><strong>A</strong>: ç›¸æœºåŠŸèƒ½å¿…é¡»åœ¨çœŸæœºä¸Šæµ‹è¯•ï¼Œæ¨¡æ‹Ÿå™¨ä¸æ”¯æŒã€‚</p>
<h3 id="Q2-JS-è°ƒç”¨æ²¡æœ‰ååº”ï¼Ÿ">Q2: JS è°ƒç”¨æ²¡æœ‰ååº”ï¼Ÿ</h3>
<p><strong>A</strong>: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li><code>WKUserContentController</code> æ˜¯å¦æ­£ç¡®æ³¨å†Œäº† <code>takePhoto</code></li>
<li>H5 ä¸­çš„è°ƒç”¨æ˜¯å¦æ­£ç¡®ï¼š<code>window.webkit.messageHandlers.takePhoto.postMessage(null)</code></li>
<li>æŸ¥çœ‹ Safari å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°é”™è¯¯</li>
</ol>
<h3 id="Q3-å¦‚ä½•è°ƒè¯•-H5-é¡µé¢ï¼Ÿ">Q3: å¦‚ä½•è°ƒè¯• H5 é¡µé¢ï¼Ÿ</h3>
<p><strong>A</strong>:</p>
<ol>
<li>çœŸæœºè¿æ¥ Mac</li>
<li>Safari â†’ å¼€å‘ â†’ [ä½ çš„è®¾å¤‡] â†’ [ä½ çš„ WebView]</li>
<li>å¯ä»¥å®æ—¶æŸ¥çœ‹æ§åˆ¶å°å’Œç½‘ç»œè¯·æ±‚</li>
</ol>
<h3 id="Q4-éœ€è¦æ”¯æŒå¤šä¸ª-JS-Handlerï¼Ÿ">Q4: éœ€è¦æ”¯æŒå¤šä¸ª JS Handlerï¼Ÿ</h3>
<p><strong>A</strong>: åœ¨é…ç½®æ—¶æ·»åŠ å¤šä¸ªï¼š</p>
<pre class="language-swift" data-language="swift"><code class="language-swift">contentController<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"takePhoto"</span></span><span class="token punctuation">)</span>
contentController<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"selectImage"</span></span><span class="token punctuation">)</span>
contentController<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"saveData"</span></span><span class="token punctuation">)</span></code></pre>
<hr>
<h2 id="ğŸ¯-æ€»ç»“">ğŸ¯ æ€»ç»“</h2>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>è¿œç¨‹ URL</th>
<th>æœ¬åœ° HTML</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ›´æ–°æ–¹å¼</td>
<td>çƒ­æ›´æ–°</td>
<td>éœ€é‡æ–°æ‰“åŒ…</td>
</tr>
<tr>
<td>ç½‘ç»œä¾èµ–</td>
<td>éœ€è¦</td>
<td>ä¸éœ€è¦</td>
</tr>
<tr>
<td>é€‚ç”¨åœºæ™¯</td>
<td>ç”Ÿäº§ç¯å¢ƒ</td>
<td>åŸå‹/Demo</td>
</tr>
<tr>
<td>æ¨èåº¦</td>
<td>â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td>â­ï¸â­ï¸â­ï¸</td>
</tr>
</tbody>
</table>
<p><strong>æ¨èæ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ğŸš€ <strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šä½¿ç”¨è¿œç¨‹ URLï¼ˆæ–¹å¼ 1ï¼‰</li>
<li>ğŸ§ª <strong>å¿«é€ŸåŸå‹</strong>ï¼šä½¿ç”¨æœ¬åœ° HTMLï¼ˆæ–¹å¼ 2ï¼‰</li>
</ul>
<hr>
<h2 id="ğŸ“š-æ‰©å±•é˜…è¯»">ğŸ“š æ‰©å±•é˜…è¯»</h2>
<p>å¦‚æœä½ éœ€è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>âœ¨ åŠ è½½æœ¬åœ° HTML æ–‡ä»¶ï¼ˆBundleï¼‰</li>
<li>ğŸ”’ HTTPS è¯ä¹¦å¿½ç•¥</li>
<li>ğŸ“® POST è¡¨å•æäº¤</li>
<li>ğŸ¨ SwiftUI ç›´æ¥å°è£… WKWebViewï¼ˆæ—  UIViewControllerï¼‰</li>
<li>ğŸ“¸ æ”¯æŒç›¸å†Œé€‰æ‹©ï¼ˆä¸åªæ˜¯ç›¸æœºï¼‰</li>
</ul>
<p>å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œæ ¸å¿ƒæ€è·¯ä¿æŒä¸å˜ã€‚</p>
<hr>
<p><strong>å®Œæ•´ä»£ç å·²æµ‹è¯•å¯è¿è¡Œ</strong> âœ…</p>
<p>Happy Coding! ğŸ‰</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/iOS/" rel="tag"># iOS</a>
              <a href="/tags/SwiftUI/" rel="tag"># SwiftUI</a>
              <a href="/tags/AI/" rel="tag"># AI</a>
              <a href="/tags/Cursor/" rel="tag"># Cursor</a>
              <a href="/tags/WKWebView/" rel="tag"># WKWebView</a>
              <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/VSCode%20Angular%E5%AE%8C%E6%95%B4%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/" rel="prev" title="Cursor/VSCode Angularå®Œæ•´å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—">
                  <i class="fa fa-angle-left"></i> Cursor/VSCode Angularå®Œæ•´å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/ffmpeg-kit-react-native%20Android%20%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE/" rel="next" title="ffmpeg-kit-react-native Android æ„å»ºé…ç½®">
                  ffmpeg-kit-react-native Android æ„å»ºé…ç½® <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">sseen</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"sseen/my_blog_utterances","issue_term":"pathname","theme":"preferred-color-scheme"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
